\section{Método de reducción}


La idea principal del algoritmo, para prevenir la explosión combinatoria que sería explorar todas las posibles soluciones, es que, en cada iteración, la \emph{pool} contenga soluciones buenas pero \emph{representativas}. Para lograr esto, es necesario contar con una medida de disimilaridad entre las soluciones de la \emph{base}, e ir eliminando sistemáticamente soluciones que pueden ser representadas por otras similares, hasta que queden solo \texttt{POOL\_SIZE} de estas.

Para realizar la reducción se requiere una medida de disimilaridad entre dos soluciones $A,B$ de la \emph{base} $B_n$ (y por lo tanto de tamaño $n$), llámese $D(A,B)$, siendo lógico que esta esté relacionada con la medida de distancia entre ubicaciones $d(u,v)$, las posibles medidas de disimilaridad se discutirán en la sección siguiente.

Un primer enfoque para resolver el problema de reducir las soluciones sería calcular las disimilaridades entre cada par de soluciones en la \emph{base}, encontrar el par con la menor dismilaridad y eliminar, de ambas, la que tenga el menor $\Phi$, repitiendo el proceso hasta que sólo quede la cantidad de soluciones requeridas.

El problema con esto es que una \emph{base} tiene $O(|X|$\texttt{POOL\_SIZE}$)$ soluciones y sería necesario calcular $O({|X|}^2$\texttt{POOL\_SIZE}$^2)$ disimilaridades, lo que también puede verse como $O({|Z|}^2$\texttt{POOL\_SIZE}$^2)$ si todas las ubicaciones de instalaciones son rentables.

Para evitar esto, dada la forma de la función objetivo y la medida de disimilitud, se puede asumir que si dos soluciones son similares \emph{geográficamente} (vale decír, respecto a que tan alejadas están sus ubicaciones de instalaciones) lo serán al ser evaluadas en la función $\Phi$.

En primer lugar, cada solución en la \emph{base} se ordena de mayor a menor valor tenga al ser evaluada en la función $\Phi$, luego, para cada una, se evalua su disimilitud sólo con las \texttt{VISION\_RANGE} siguientes, se detecta el par con la menor dismilaridad y del par se elimina el de menor $\Phi$. Tras esta eliminación, se calculan una disimilaridad más para cada una de las soluciones que estaban antes de la que se eliminó (a menos de \texttt{VISION\_RANGE} posiciones) a fin de que se sigan teniendo las disimilaridades \texttt{VISION\_RANGE} soluciones adelante. Este proceso se repite hasta que sólo quedan \texttt{POOL\_SIZE} soluciones.

Esta heurística puede ser aplicada para tener el mismo resultado que el primer enfoque, siempre y cuando \texttt{VISION\_RANGE} sea suficiente, porque se da que las soluciones más \emph{geograficamente} similares, tienen valor similares en la función $\Phi$ y, si no alcanzan a estar a lo mas a \texttt{VISION\_RANGE} posiciones en la \emph{base}, conforme esta se va reduciendo, lo estarán. Aplicar esto reduce la cantidad de disimilitudes a calcular de $O(|Z|^2$\texttt{POOL\_SIZE}$^2)$ a $O(|Z|$\texttt{POOL\_SIZE} \texttt{VISION\_RANGE}$)$.

\begin{figure}
\centering
\scriptsize
\subfloat[Detección de la disimilitud menor.]{
\begin{tabular}{ |c c c c c c c c| }
\hline
$S_1$ & $S_2$ & $S_3$ & $S_4$ & $S_5$ & $S_6$ & $S_7$ & $S_8$ \\
\hline
$D(S_1,S_2)$ & $D(S_2,S_3)$ & $D(S_3,S_4)$ & $D(S_4,S_5)$ &
$D(S_5,S_6)$ & $D(S_6,S_7)$ & $D(S_7,S_8)$ & \\
$D(S_1,S_3)$ & \hlc[red]{$D(S_2,S_4)$} & $D(S_3,S_5)$ & $D(S_4,S_6)$ &
$D(S_5,S_7)$ & $D(S_6,S_8)$ & & \\
$D(S_1,S_4)$ & $D(S_2,S_5)$ & $D(S_3,S_6)$ & $D(S_4,S_7)$ &
$D(S_5,S_8)$ & & & \\
\hline
\end{tabular}
} \vfill

\subfloat[Eliminación de la solución de menor ganancia.]{
\begin{tabular}{ |c c c c c c c c| }
\hline
$S_1$ & $S_2$ & $S_3$ & \st{$S_4$} & $S_5$ & $S_6$ & $S_7$ & $S_8$ \\
\hline
$D(S_1,S_2)$ & $D(S_2,S_3)$ & \st{$D(S_3,S_4)$} & \st{$D(S_4,S_5)$} &
$D(S_5,S_6)$ & $D(S_6,S_7)$ & $D(S_7,S_8)$ & \\
$D(S_1,S_3)$ & \st{$D(S_2,S_4)$} & $D(S_3,S_5)$ & \st{$D(S_4,S_6)$} &
$D(S_5,S_7)$ & $D(S_6,S_8)$ & & \\
\st{$D(S_1,S_4)$} & $D(S_2,S_5)$ & $D(S_3,S_6)$ & \st{$D(S_4,S_7)$} &
$D(S_5,S_8)$ & & & \\
\hline
\end{tabular}
} \vfill

\subfloat[Inserción de nuevas disimilitudes.]{
\begin{tabular}{ |c c c c c c c c| }
\hline
$S_1$ & $S_2$ & $S_3$ & \st{$S_4$} & $S_5$ & $S_6$ & $S_7$ & $S_8$ \\
\hline
$D(S_1,S_2)$ & $D(S_2,S_3)$ & \st{$D(S_3,S_4)$} & \st{$D(S_4,S_5)$} &
$D(S_5,S_6)$ & $D(S_6,S_7)$ & $D(S_7,S_8)$ & \\
$D(S_1,S_3)$ & \st{$D(S_2,S_4)$} & $D(S_3,S_5)$ & \st{$D(S_4,S_6)$} &
$D(S_5,S_7)$ & $D(S_6,S_8)$ & & \\
\st{$D(S_1,S_4)$} & $D(S_2,S_5)$ & $D(S_3,S_6)$ & \st{$D(S_4,S_7)$} &
$D(S_5,S_8)$ & & & \\
\hlc[green]{$D(S_1,S_5)$} & \hlc[green]{$D(S_2,S_6)$} &
\hlc[green]{$D(S_3,S_7)$} & & & & & \\
\hline
\end{tabular}
}
\caption{Ejemplo de un paso del proceso de reducción, se tienen 8 soluciones $S_1,S_2,...,S_8$ de mayor a menor función objetivo, inicialmente se tiene la disimilitud entre cada solución y las \texttt{VISION\_RANGE} siguientes (en este caso \texttt{VISION\_RANGE}$=3$). Una vez se encuentra la menor disimilitud (mostrada en rojo), se elimina la solución de menor función objetivo del par.\\ Finalmente se computan nuevas disimilitudes (mostradas en verde) para que la disimilitudes de cada solución con sus \texttt{VISION\_RANGE} siguientes se sigan teniendo. El proceso se repite hasta que sólo quedan \texttt{POOL\_SIZE} soluciones.}
\label{fig:reduction}
\end{figure}
